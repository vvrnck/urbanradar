(function(e){function t(t){for(var o,r,i=t[0],l=t[1],c=t[2],d=0,u=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&u.push(s[r][0]),s[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);p&&p(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],o=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(o=!1)}o&&(n.splice(t--,1),e=r(r.s=a[0]))}return e}var o={},s={"app~5a11b65b":0},n=[];function r(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=o,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var p=l;n.push([0,"node_vendors~app~2cece08c","node_vendors~app~e0f7d667","node_vendors~app~1fb195ae","node_vendors~app~b85af4ba","node_vendors~app~a9f132cc","node_vendors~app~aff78fda","node_vendors~app~2a42e354","node_vendors~app~7274e1de","node_vendors~app~db300d2f","node_vendors~app~2aec3c5f","node_vendors~app~2119ef82","node_vendors~app~ec219104","node_vendors~app~be6a9b4d","node_vendors~app~c2224056","node_vendors~app~d71bf088","node_vendors~app~ad52ea04","node_vendors~app~41ff223c","node_vendors~app~95168f36","node_vendors~app~4281a6e6","node_vendors~app~788458c0","node_vendors~app~9d05791b","node_vendors~app~a813af4b","node_vendors~app~26197e6c","node_vendors~app~64e68313","node_vendors~app~18ddbf7f","node_vendors~app~60da9140","node_vendors~app~e80252b6","node_vendors~app~588225d9","node_vendors~app~c74e00d9","node_vendors~app~f0c0d806","node_vendors~app~eb9222fc","node_vendors~app~bdcda83c","node_vendors~app~c259bd06","node_vendors~app~ef4b7b69","node_vendors~app~89affa73","node_vendors~app~6919f23e","node_vendors~app~1ccf8e8a","node_vendors~app~77bf5e45","node_vendors~app~399b027d","node_vendors~app~e258e298","node_vendors~app~8eeb4602","node_vendors~app~7db804d5","node_vendors~app~15f0789d","node_vendors~app~cc99a214","node_vendors~app~0a56fd24","node_vendors~app~b58f7129","node_vendors~app~73d8ab38","node_vendors~app~fdc6512a","node_vendors~app~02576867","node_vendors~app~0605657e","node_vendors~app~2ad8cef7","node_vendors~app~b428c7fb","node_vendors~app~be0d8011","node_vendors~app~b83873af","node_vendors~app~dbbd9252","node_vendors~app~d2305125","node_vendors~app~3e8ca441","node_vendors~app~69023aca","node_vendors~app~4ce74e55","node_vendors~app~2900d54e","node_vendors~app~cfcd6536","node_vendors~app~f538a826","node_vendors~app~86eb0c16","node_vendors~app~fd542d86","node_vendors~app~ef1497bc","node_vendors~app~cf44736e","app~d0ae3f07","app~06837ae4","app~21833f8f","app~fb5be6bb","app~1ad7283e"]),a()})({"0311":function(e,t,a){},"07a4":function(e,t,a){"use strict";var o=a("2b0e"),s=a("2f62"),n=a("c1df"),r=a.n(n);o["default"].use(s["a"]);let i=r()().format("yyyy-MM-DD");const l=new s["a"].Store({state:{menu:!0,filter:!0,layerOverlay:!1,map:{layerGroups:[],loading:!0},dates:[i,i],sections:[],layers:{},selectedLayers:[],initialLayers:{},availableDates:{},snackbar:{open:!1,color:"",text:"",timeout:2500,type:""},legend:!1,drawDialog:{open:!1,layer:null,feature:null,type:""},featureData:{layer_id:null,tenant_id:null,feature_collection_id:null,language:"pt",fields:[],properties:{},geometry:null,type:null,popup:null},tabs:[],mobile:{toggle:{layers:!1,dates:!1,settings:!1,fullscreen:!1,caption:!1,feature:!1},sections:[],draw:{type:"",layer:null,feature:null}}},mutations:{setMap(e,t){e.map=t},setMenu(e,t){e.menu=t},setFilter(e,t){e.filter=t},setDates(e,t){e.dates=t},setInitialLayers(e,t){e.initialLayers=t},setLayers(e,t){e.layers=t},setSelectedLayers(e,t){e.selectedLayers=t},setAvailableDates(e,t){e.availableDates=t},setSnackbar(e,t){e.snackbar=t},setLegend(e,t){e.legend=t},setDrawDialog(e,t){e.drawDialog=t},setLayerOverlay(e,t){e.layerOverlay=t},setFeatureData(e,t){e.featureData=t},setTabs(e,t){e.tabs=t},setMobile(e,t){e.mobile=t}},getters:{map:e=>e.map,menu:e=>e.menu,filter:e=>e.filter,dates:e=>e.dates,layers:e=>e.layers,selectedLayers:e=>e.selectedLayers,initialLayers:e=>e.initialLayers,availableDates:e=>e.availableDates,snackbar:e=>e.snackbar,legend:e=>e.legend,drawDialog:e=>e.drawDialog,layerOverlay:e=>e.layerOverlay,featureData:e=>e.featureData,tabs:e=>e.tabs,mobile:e=>e.mobile},actions:{updateMap(e,t){e.commit("setMap",t)},updateMenu(e,t){e.commit("setMenu",t)},updateFilter(e,t){e.commit("setFilter",t)},updateDates(e,t){e.commit("setDates",t)},updateInitialLayers(e,t){e.commit("setInitialLayers",t)},updateLayers(e,t){e.commit("setLayers",t)},updateSelectedLayers(e,t){e.commit("setSelectedLayers",t)},updateAvailableDates(e,t){e.commit("setAvailableDates",t)},updateSnackbar(e,t){e.commit("setSnackbar",t)},updateLegend(e,t){e.commit("setLegend",t)},updateDrawDialog(e,t){e.commit("setDrawDialog",t)},updateLayerOverlay(e,t){e.commit("setLayerOverlay",t)},updateFeatureData(e,t){e.commit("setFeatureData",t)},updateTabs(e,t){e.commit("setTabs",t)},updateMobile(e,t){e.commit("setMobile",t)}}});t["a"]=l},"08cb":function(e,t,a){"use strict";a("3978")},"20a9":function(e,t,a){"use strict";a("2724")},2724:function(e,t,a){},"2e3a":function(e,t,a){"use strict";a("3648")},"2e58":function(e,t,a){"use strict";a("0311")},3193:function(e,t,a){"use strict";a("a92c")},3535:function(e,t,a){},3648:function(e,t,a){},3978:function(e,t,a){},"3a05":function(e,t,a){"use strict";a("737a")},"3e7c":function(e,t,a){"use strict";a("3535")},4447:function(e,t,a){"use strict";a("4b6a")},"4b6a":function(e,t,a){},"4ba6":function(e,t,a){},"5c03":function(e,t,a){"use strict";a("8089")},6660:function(e,t,a){"use strict";a("bf38")},6670:function(e,t,a){"use strict";a("691e")},"691e":function(e,t,a){},"694d":function(e,t,a){"use strict";a("4ba6")},7366:function(e,t,a){"use strict";a("da87")},"737a":function(e,t,a){},7735:function(e,t,a){"use strict";a("c2fe")},"7c41":function(e,t,a){"use strict";var o=a("2b0e"),s=a("ce5b"),n=a.n(s);a("bf40"),a("5363");o["default"].use(n.a);const r={theme:{dark:!0},icons:{iconfont:"mdi"}};t["a"]=new n.a(r)},8089:function(e,t,a){},8138:function(e,t,a){},"858f":function(e,t,a){"use strict";a("e6aa")},"8db4":function(e,t,a){},"90b8":function(e,t,a){"use strict";a.r(t);var o=a("2b0e"),s=a("2536"),n=a.n(s);a("2440");o["default"].use(n.a)},"90ba":function(e,t,a){},a92c:function(e,t,a){},b32a:function(e,t,a){"use strict";a("8db4")},bbd2:function(e,t,a){"use strict";(function(e){a("14d9");var o=a("e11e"),s=a.n(o),n=(a("bc3a"),a("48ec"),a("2ef0")),r=a("ed08");t["a"]={name:"FeatureCreation",data(){return{loading:!1,file:null,reader:null,timeline:!1}},mounted(){},methods:{drawPointInMap(){const e=this.$store.getters.mobile,t=e.draw.layer,o=Object.assign({},t),{id:i,filters:l,style:c}=o;let p=this.$i18n.locale,d=!0,u=!0;if(l.map(e=>{e.key&&""!==e.key||(d=!1),""===e.key&&"image"===e.type&&(u=!1),this.file||(u=!1)}),!u){const e={open:!0,color:"",text:"warning_upload_file",timeout:2500,type:"warning"};return this.$store.dispatch("updateSnackbar",e)}if(!d){const e={open:!0,color:"",text:"warning_fill_fields",timeout:2500,type:"warning"};return this.$store.dispatch("updateSnackbar",e)}Object(r["u"])("feature",!1);const{extra_props:m}=c;let f={};m&&m.marker&&Object.keys(m.marker).map(e=>f[e]=m.marker[e]);let g="",h=[];l.map(e=>{const{id:t,name:a,key:o}=e;h.push({key:o,value:"1",field_config_id:t});let s=e.label&&e.label[p]?e.label[p]:e.name,n="";"image"===e.type?n+=`${s}: <a href='${o}' target='_blank'>${o}</a> <br />`:n+=`${s}: ${o} <br />`,g+=n});let v=a("078f");Object(n["isEmpty"])(f)||(Object(n["isEmpty"])(f.icon)&&""===f.icon.trim()||(v=a("67f7")("./"+f.icon)),Object(n["isEmpty"])(f.image)&&""===f.image.trim()||(v=f.image));const y=window._map;console.log(y);var b=new s.a.Draw.Marker(y,{icon:s.a.icon({iconRetinaUrl:v,iconUrl:v,iconSize:[32,32],iconAnchor:[16,37],popupAnchor:[0,-30]})});b.enable();let _=Object.assign({},this.$store.getters.featureData),k=JSON.parse(sessionStorage.getItem("featureCollections"))[0];_={..._,layer_id:i,tenant_id:"1",feature_collection_id:k.id,language:this.$i18n.locale,fields:h,properties:f,popup:g},this.$store.dispatch("updateMobile",{...e,draw:{...e.draw,feature:_}})},onChangeFile(e){if(!e)return;const t=new FileReader;t.readAsDataURL(e),t.addEventListener("load",()=>{this.reader={name:e.name,data:t.result}})},async getFileURL(t){if(console.log(t),this.loading=!0,!this.reader||!this.file){this.loading=!1;const e={open:!0,color:"",text:"warning_send_file",timeout:2500,type:"warning"};return this.$store.dispatch("updateSnackbar",e)}if(!this.reader)return this.loading=!1;const{name:a,data:o}=this.reader;new e(o.replace(/^data:image\/\w+;base64,/,""),"base64")},getLabel(e,t){return Object(r["k"])(e,t)},toggleFeature(){const e=this.$store.getters.mobile;Object(r["u"])("feature",!e.toggle.feature)}},computed:{feature(){const e=this.$store.getters.mobile;return e.toggle.feature},draw(){const e=this.$store.getters.mobile;return e.draw}}}}).call(this,a("b639").Buffer)},bc90:function(e,t,a){"use strict";a("8138")},bf38:function(e,t,a){},c2fe:function(e,t,a){},c6d3:function(e,t,a){"use strict";a("e34f")},cd94:function(e,t,a){"use strict";var o=a("2b0e"),s=a("8c4f"),n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-page"},[t("v-flex",{staticClass:"login-form-wrapper",attrs:{"d-flex":"","justify-center":"","align-center":""}},[t("div",{staticClass:"login-form"},[t("v-form",[t("div",{staticClass:"form-header"},[t("img",{attrs:{src:a("e347"),alt:"UrbanMap"}}),e.loading?t("Loading",{attrs:{color:"#52FFEE",type:"linear"}}):e._e()],1),t("div",{staticClass:"form-body"},[t("div",{staticClass:"form-fields"},e._l(e.inputs,(function(a){return t("div",{key:a.name},[t("v-text-field",{attrs:{dark:"",name:a.name,type:a.type,color:a.color,counter:a.counter,rules:a.rules,required:a.required,label:""+e.$t(a.label),"append-icon":a.appendIcon.hasIcon?a.appendIcon.iconOn:a.appendIcon.iconOff,autocomplete:"off"},on:{"click:append":()=>{a.appendIcon.hasIcon=!a.appendIcon.hasIcon,a.type="text"===a.type?"password":"text"},keydown:function(t){if(!t.type.indexOf("key")&&13!==t.keyCode)return null;"password"===a.name&&e.login()}},model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"input.value"}})],1)})),0),t("div",{staticClass:"form-actions"},[t("div",{staticClass:"form-actions-links"},[t("div",{on:{click:function(t){return e.forgotPassword()}}},[e._v(" "+e._s(e.$t("forgot_password"))+" ")])]),t("v-btn",{attrs:{block:"",dark:""},on:{click:function(t){return e.login()}}},[e.loading?t("div",[e.loading?t("Loading",{attrs:{color:"#FFF",type:"circular",page:"login"}}):e._e()],1):e._e(),e.loading?e._e():t("div",[e._v(" "+e._s(e.$t("btn_login"))+" ")])])],1)]),t("div",{staticClass:"form-footer"},[t("div",{staticClass:"system-version"},[e._v(" "+e._s(e.getVersion)+" ")])])])],1)])],1)},r=[],i=(a("14d9"),a("260b")),l=(a("ea7b"),a("ed08")),c=a("bc3a"),p=a.n(c),d=a("2ef0"),u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"layer-menu"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.getLayerMenuState(),expression:"!getLayerMenuState()"}],on:{click:function(t){return e.toggleLayer()}}},[t("v-icon",[e._v(" mdi-layers ")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.getLayerMenuState(),expression:"getLayerMenuState()"}]},[t("div",{staticClass:"layer-menu-action",on:{click:function(t){return e.toggleLayer()}}},[t("v-icon",[e._v("mdi-close")])],1),t("Layers",{attrs:{loadFeatures:e.loadFeatures,close:"toggleLayer"}})],1)])},m=[],f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"layers"},e._l(e.menuItems,(function(a,o){return t("div",{key:o},[a.section?t("div",e._l(a.data,(function(a){return t("div",{key:a.name,staticClass:"layer-menu-item"},[t("v-switch",{attrs:{light:"",color:"#00FFFF",dense:"",label:a.name},on:{change:()=>e.onChange(a)},model:{value:a.selected,callback:function(t){e.$set(a,"selected",t)},expression:"layer.selected"}})],1)})),0):e._e()])})),0)},g=[],h=a("c1df"),v=a.n(h),y={name:"Layers",props:["close","loadFeatures"],data(){return{}},mounted(){const e=Object(l["b"])("layer");p.a.get(e).then(e=>{const{data:t,errors:a}=e.data;if(t.map(e=>{e.layers.map(e=>{const{extra_props:t}=e.style;t&&t.mobile&&("icon"===t.type||"marker"===t.type)&&(e.selected=!0)})}),!Object(d["isEmpty"])(a))return Object(l["g"])(a);const o=Object.assign([],t),s=Object.assign([],o);this.$store.dispatch("updateInitialLayers",s),localStorage.setItem("menu",JSON.stringify(o)),this.$store.dispatch("updateLayers",o),this.loadFeatures()})},methods:{onChange(e){const t=this.$store.getters.layers,a=Object.assign([],t);a.map(t=>{t.layers.map(t=>{t.id!==e.id&&(t.selected=!1)})}),this.$store.dispatch("updateLayers",a),this.loadFeatures()}},computed:{menuItems(){return this.$store.getters.layers}}},b=y,_=(a("bc90"),a("2877")),k=Object(_["a"])(b,f,g,!1,null,null,null),w=k.exports,x={name:"LayerMenu",components:{Layers:w},props:["loadFeatures"],data(){return{}},methods:{toggleLayer(){let e=this.$store.getters.menu;if(e.layers)return this.$store.dispatch("updateMenu",{dates:!1,layers:!1,settings:!1});this.$store.dispatch("updateMenu",{dates:!1,layers:!0,settings:!1})},getLayerMenuState(){return this.$store.getters.menu.layers}}},$=x,O=(a("6660"),Object(_["a"])($,u,m,!1,null,null,null)),C=O.exports,L=function(){var e=this,t=e._self._c;return t("div",{staticClass:"date-menu"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.getDateMenuState(),expression:"!getDateMenuState()"}],staticStyle:{display:"flex","align-items":"center","justify-content":"center",width:"44px",height:"44px"},on:{click:function(t){return e.toggleDate()}}},[t("v-icon",[e._v(" mdi-calendar-multiple ")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.getDateMenuState(),expression:"getDateMenuState()"}]},[t("div",{staticClass:"date-menu-action",on:{click:function(t){return e.toggleDate()}}},[t("v-icon",[e._v("mdi-close")])],1),t("Date",{attrs:{close:e.toggleDate}})],1)])},F=[],S=function(){var e=this,t=e._self._c;return t("div",{staticClass:"date-picker"},[t("v-date-picker",{attrs:{flat:"","full-width":"",range:"","header-color":"white",color:"#00FFFF",locale:"pt-BR"},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}})],1)},j=[],M={name:"Date",props:["close"],data(){return{}},computed:{dates:{get(){return this.$store.getters.dates},set(e){this.$store.dispatch("updateDates",e),2==e.length&&this.close()}}}},E=M,I=(a("c6d3"),Object(_["a"])(E,S,j,!1,null,null,null)),A=I.exports,D={name:"DatePicker",props:["loadFeatures"],components:{Date:A},data(){return{}},methods:{toggleDate(){const e=this.$store.getters.mobile,t=e.toggle.dates,a=this.$store.getters.dates;if(t){if(document.getElementById("date-map-control").style.bottom="35px",this.$store.dispatch("updateMobile",{...e,toggle:{layers:!1,dates:!1,settings:!1,fullscreen:!1,caption:!1,feature:!1}}),Object(d["isEmpty"])(a))return;return this.loadFeatures()}Object(l["u"])("dates",!0),document.getElementById("date-map-control").style.bottom="50%"},getDateMenuState(){const e=this.$store.getters.mobile;return e.toggle.dates}}},P=D,N=(a("3a05"),Object(_["a"])(P,L,F,!1,null,null,null)),T=N.exports,R=function(){var e=this,t=e._self._c;return t("div",["linear"===e.type?t("div",[t("v-progress-linear",{attrs:{indeterminate:"",color:e.color}})],1):e._e(),"circular"===e.type?t("div",{class:"login"!==e.page&&"circular"},[t("v-progress-circular",{attrs:{size:"login"!==e.page?30:25,width:2,color:e.color,indeterminate:""}})],1):e._e()])},G=[],z={name:"Loading",props:["color","type","page"]},q=z,U=(a("08cb"),Object(_["a"])(q,R,G,!1,null,null,null)),Y=U.exports,B=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"map-mobile"}},[t("div",{staticClass:"map-wrapper"},[t("div",{staticClass:"map-loading"},[e.loading?t("Loading",{attrs:{color:"#52FFEE",type:"circular"}}):e._e()],1),t("div",{attrs:{id:"map"}},[t("LMap",{ref:e.map.mapRef,attrs:{zoom:e.map.zoom,center:e.map.centerMapCoords,options:e.map.options},on:{click:function(t){return e.closeAll()}}},[t("LControlLayers",{attrs:{position:"topright"}}),t("LControl",{staticClass:"clear-map-control",attrs:{position:"topright"}},[t("div",{staticClass:"leaflet-control-layers control",on:{click:function(t){return e.clearMapData()}}},[t("v-icon",[e._v(" mdi-broom ")])],1)]),t("LControl",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"search-features-control",attrs:{position:"topright"}},[t("div",{staticClass:"leaflet-control-layers control",on:{click:function(t){return e.loadFeatures()}}},[t("v-icon",[e._v(" mdi-magnify ")])],1)]),e._l(e.map.geojsons,(function(e,a){return t("LGeoJson",{key:a,attrs:{geojson:e.data,options:e.options}})})),t("LControl",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"layer-control",attrs:{position:"bottomleft"}},[t("div",{staticClass:"control"},[t("LayerMenu",{attrs:{loadFeatures:e.loadFeatures}})],1)]),e._l(e.map.tileLayers,(function(e){return t("LTileLayer",{key:e.name,attrs:{url:e.url,visible:e.visible,name:e.label,attribuition:e.options.attibuition,subdomains:e.options.subdomains,"layer-type":"base"}})})),e._l(e.map.layerGroups,(function(a,o){return t("LLayerGroup",{key:"LAYER_GROUP"+o,ref:"layerGroup",refInFor:!0,attrs:{visible:a.visible,layerType:a.type,name:`${a.name} (${a.featuresAmount})`}},[e._l(a.features.polygon,(function(e,a){return t("LPolygon",{key:"POLYGON"+a,attrs:{options:{id:e.id,name:e.name,value:e.value,defaultStyle:e.defaultStyle,polygon:e._polygon},latLngs:e.geometry,color:e.color,fillColor:e.fillColor,fillOpacity:e.fillOpacity,opacity:e.opacity,weight:e.weight}})})),e._l(a.features.imageOverlay,(function(e,a){return t("LImageOverlay",{key:"IMAGE_OVERLAY"+a,attrs:{className:"IMAGE_OVERLAY_"+e.id,options:{id:e.id,name:e.name},bounds:e.bounds,url:e.url,interactive:e.interactive,zIndex:e.zIndex,opacity:e.opacity}})})),t("LMarkerCluster",{ref:"markerClusterRef",refInFor:!0,attrs:{options:{disableClusteringAtZoom:13}}},e._l(a.features.marker,(function(e,a){return t("LMarker",{key:"MARKER"+a,attrs:{latLng:e.geometry,options:{id:e.id,name:e.name}}},[t("LPopup",{attrs:{content:e.text}}),t("LIcon",{attrs:{iconUrl:e.iconUrl,iconRetinaUrl:e.iconRetinaUrl,iconSize:e.iconSize,iconAnchor:e.iconAnchor,popupAnchor:e.popupAnchor}})],1)})),1),t("LMarkerCluster",{ref:"pointClusterRef",refInFor:!0,attrs:{options:{disableClusteringAtZoom:15}}},e._l(a.features.point,(function(e,a){return t("LCircle",{key:"POINT"+a,attrs:{latLng:e.geometry,color:e.color,fillColor:e.fillColor,fillOpacity:e.fillOpacity,radius:e.radius}})})),1)],2)})),t("LControl",{staticClass:"map-watermark",attrs:{position:"bottomleft"}},[t("img",{staticClass:"logo-watermark",attrs:{src:a("18b2")}})])],2)],1),t("div",{staticClass:"date-visor"},[t("div",{staticClass:"leaflet-control-layers control"},[e._v(" "+e._s(e.dates)+" ")])]),t("CustomControl",{attrs:{map:e.map,goToInitialLocation:e.goToInitialLocation}}),t("FeatureCreation"),t("Filters",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{loadFeatures:e.loadFeatures}}),t("SelectedFilters",{attrs:{loadFeatures:e.loadFeatures}}),t("div",{staticClass:"date-map-control",attrs:{id:"date-map-control"}},[t("div",{staticClass:"leaflet-control-layers control"},[t("DatePicker",{attrs:{loadFeatures:e.loadFeatures}})],1)]),t("v-dialog",{staticClass:"popup",attrs:{fullscreen:"",transition:"dialog-bottom-transition",scrollable:""},model:{value:e.popup.open,callback:function(t){e.$set(e.popup,"open",t)},expression:"popup.open"}},[t("div",{staticClass:"popup-content"},[t("div",{staticClass:"popup-header"},[t("span",[e._v(" "+e._s(e.popup.data&&e.popup.data.name)+" ")]),t("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){return e.closePopup()}}},[t("v-icon",[e._v("mdi-close")])],1)],1),t("div",{staticClass:"popup-body"},e._l(e.popup.charts,(function(a,o){return t("div",{key:o,staticClass:"chart"},[!["dynamic_bar"].includes(a.chart_options.chart.type)&&a.series.length>0?t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[t("apexchart",{attrs:{type:a.chart_options.chart.type,options:a.chart_options,series:a.series,height:365}})],1):e._e()])})),0)])]),t("div",{staticClass:"actions-control",staticStyle:{display:"none"}},[t("div",{staticClass:"actions"},[t("div",{staticClass:"action-buttons"},[t("div",{staticClass:"control btn-reset",on:{click:function(t){return e.clearMapData()}}},[e._v(" Reset ")]),t("div",{staticClass:"control action-button btn-apply",on:{click:function(t){return e.loadFeatures()}}},[e._v(" Apply ")])])])])],1)])},H=[],J=(a("b7ef"),a("e11e")),V=a.n(J),Z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"navbar"},[t("v-app-bar",{attrs:{app:"",color:"black",dark:"",height:"56px"}},[t("v-app-bar-nav-icon",{directives:[{name:"show",rawName:"v-show",value:e.hasMenu,expression:"hasMenu"}],on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),t("v-toolbar-title",[t("div",{staticClass:"navbar-toolbar-desktop"},[e._v(" "+e._s(e.$t(e.title))+" "),t("img",{staticClass:"logo-principal",attrs:{width:"100px",src:a("e347")}})]),t("div",{staticClass:"navbar-toolbar-mobile"},[t("img",{attrs:{src:a("9d64"),width:"40px"}}),t("div",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.$t(e.title)))]),t("v-menu",{staticClass:"global-overlap-index",attrs:{right:"",bottom:"",dark:"","close-on-click":""},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:o}){return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",o,!1),a),[t("v-icon",[e._v("mdi-menu-down")])],1)]}}])},[t("v-list",e._l(e.items,(function(a){return t("v-list-item",{key:a.label,on:{click:()=>{}}},[t("v-list-item-title",{on:{click:function(t){return e.goToPage(a)}}},[e._v(e._s(e.$t(a.name)))])],1)})),1)],1)],1)]),t("v-toolbar-items",{staticClass:"ml-5"},[t("div",{staticClass:"navbar-toolbar-items"},e._l(e.items,(function(a){return t("div",{key:a.label,staticClass:"navbar-toolbar-item",on:{click:function(t){return e.goToPage(a)}}},[e._v(" "+e._s(e.$t(a.name))+" ")])})),0)]),t("v-spacer"),t("div",{staticClass:"navbar-email"},[t("v-icon",{attrs:{dark:""}},[e._v("mdi-account-circle")])],1),t("v-menu",{staticClass:"global-overlap-index",attrs:{left:"",bottom:"",dark:""},on:{"click:outside":()=>{}},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:o}){return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",o,!1),a),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}])},[t("v-list",e._l(e.options,(function(a){return t("v-list-item",{key:a.label,on:{click:()=>{}}},[t("v-list-item-title",[e._v(e._s(a.label))])],1)})),1)],1)],1),t("v-navigation-drawer",{staticClass:"global-overlap-index drawer",attrs:{absolute:"",temporary:"",dark:"",color:"#131313"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[t("v-list-item",[t("v-list-item-avatar",[t("v-avatar",{staticClass:"black--text",attrs:{color:"#52FFEE"}})],1),t("v-list-item-content"),t("v-btn",{attrs:{icon:"",fab:"",dark:"",small:""},on:{click:function(t){return e.closeDrawer()}}},[t("v-icon",[e._v("mdi-close")])],1)],1),t("v-divider"),t("v-list",{attrs:{dense:""}},[e._l(e.menuItems,(function(a){return t("v-list-item",{key:a.order,attrs:{link:""},on:{click:function(t){return e.openLayerOptions(a)}}},[t("v-list-item-icon",[t("v-icon",{attrs:{color:"#52FFEE"}},[e._v("mdi-home")])],1),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(a.section&&a.section.display_name))])],1)],1)})),t("v-divider"),t("v-list-item",{attrs:{link:""},on:{click:function(t){return e.logout()}}},[t("v-list-item-icon",[t("v-icon",[e._v("mdi-keyboard-return")])],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Sair")])],1)],1)],2),t("LayerMenu",{attrs:{layer:e.layerOptions,close:()=>e.closeLayerOptions(),availableDates:e.availableDates}}),t("div",{staticClass:"drawer-actions-wrapper"},[t("div",{staticClass:"drawer-actions-buttons"},[t("v-btn",{attrs:{rounded:"",dark:"",color:"#F44E3B","min-width":"105",ripple:""},on:{click:function(t){return e.resetMapConfigs()}}},[e._v(" "+e._s(e.$t("btn_reset"))+" ")]),t("v-btn",{attrs:{rounded:"",dark:"",color:"#6DC1B2","min-width":"105",ripple:""},on:{click:function(t){return e.getFeatures()}}},[e._v(" "+e._s(e.$t("btn_apply"))+" ")])],1)])],1)],1)},K=[],W={name:"NavBar",props:["user","title","loadFeatures","reset","hasMenu"],components:{LayerMenu:C},data(){return{drawer:!1,items:[{icon:"mdi-home",name:"map",label:"Map",scopes:[""],route:"map"},{icon:"mdi-home",name:"management",label:"Management",scopes:[""],route:"manage"},{icon:"mdi-home",name:"feedback",label:"User Feedback",scopes:[""],route:"feedback"},{icon:"mdi-home",name:"helper",label:"Helper",scopes:[""],route:"help"}],options:[{icon:"mdi-home",label:"Users",scopes:[""]},{icon:"mdi-home",label:"Feedbacks List",scopes:[""]},{icon:"mdi-home",label:"Exit",scopes:[""]}],layerOptions:{show:!1,sectionName:null,options:[]},availableDates:null}},mounted(){const e=Object(l["b"])("layer");p.a.get(e).then(e=>{const t=Object.assign({},e.data),a=Object.assign({},e.data);Object.values(t).map(e=>{e.data.map(e=>{const t=v()().format("YYYY-MM-DD");e.dates=[t,t],e.colorScale=e.colorFeat,e.rateScale=[.1,.2,.4,.6,.7,1],e.types=[{name:"hexagon",value:!1},{name:"scale",value:!1},{name:"icon",value:!1},{name:"marker",value:!1},{name:"point",value:!1}],e.texture={value:"NONE",options:["NONE","HORIZONTAL","VERTICAL"]},e.open=!1,e.filters=[],e.groups.map((t,a)=>{e.filters[a]={type:t.type,name:t.type,label:t.type,value:"",items:[],tags:[]},t.subtype.map(t=>{e.filters[a].items.push({id:t.id,text:t.name,toLowerCase:()=>t.name.toLowerCase(),toString:()=>t.name})})})})}),this.$store.dispatch("updateMenu",t),localStorage.setItem("initialMenuData",JSON.stringify(a))})},methods:{goToPage(e){this.$router.push(e.route).catch(e=>console.warn(e))},resetMapConfigs(){this.reset().then(()=>{const e=JSON.parse(localStorage.getItem("initialMenuData"));this.$store.dispatch("updateMenu",e),this.layerOptions={show:!1,sectionName:null,options:[]}})},getFeatures(){this.loadFeatures().then(()=>{this.drawer=!1,this.$store.dispatch("updateCaption",!0)})},closeDrawer(){this.drawer=!1},openLayerOptions(e){this.layerOptions={show:!0,name:e.section.name,options:e.data}},closeLayerOptions(){this.layerOptions.show=!1},getUser(){const e=i["a"].auth().currentUser;return e},changeTheme(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark},logout(){}},computed:{menuItems(){return this.$store.getters.menu}}},Q=W,X=(a("694d"),Object(_["a"])(Q,Z,K,!1,null,null,null)),ee=X.exports,te=function(){var e=this,t=e._self._c;return t("v-snackbar",{staticClass:"snackbar",attrs:{timeout:e.options.timeout,color:e.options.color,absolute:"",rounded:"pill"},scopedSlots:e._u([{key:"action",fn:function({attrs:a}){return[t("v-btn",e._b({staticClass:"snackbar-button",attrs:{color:e.close_color,text:""},on:{click:function(t){e.options.open=!1}}},"v-btn",a,!1),[e._v(" Close ")])]}}]),model:{value:e.options.open,callback:function(t){e.$set(e.options,"open",t)},expression:"options.open"}},[e._v(" "+e._s(e.$t(e.options.text))+" ")])},ae=[],oe={name:"Snackbar",props:["options"],data(){return{close_color:"#FFF"}}},se=oe,ne=(a("fbfe"),Object(_["a"])(se,te,ae,!1,null,null,null)),re=ne.exports,ie=a("ca9f"),le=a("2699"),ce=a("a40a"),pe=a("c8b6"),de=a("9ee8"),ue=a("2253"),me=a("044a"),fe=a("258a"),ge=a("e464"),he=a("1ebb"),ve=a("4e2b"),ye=a("fbba"),be=a("0dbd"),_e=a("f60f"),ke=function(){var e=this,t=e._self._c;return t("div",{staticClass:"custom-control"},[t("div",{staticClass:"settings-control"},[t("div",{staticClass:"leaflet-control-layers control",on:{click:function(t){return e.toggleSettings()}}},[t("v-icon",[e._v(" mdi-cog ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.settings,expression:"settings"}],staticClass:"menu-control",on:{click:function(t){return e.toggleSettings()}}},[t("div",{staticClass:"menu-options"},[t("div",{staticClass:"location-control"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.settings,expression:"settings"}],staticClass:"leaflet-control-layers control",on:{click:function(t){return e.goToInitialLocation()}}},[t("v-icon",[e._v(" mdi-crosshairs-gps ")])],1)]),t("div",{staticClass:"location-control"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.settings,expression:"settings"}],staticClass:"leaflet-control-layers control",on:{click:function(t){return e.toggleFeature()}}},[t("v-icon",[e._v(" mdi-map-marker ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.settings,expression:"settings"}],staticClass:"caption-control",attrs:{position:"topleft"}},[t("div",{staticClass:"leaflet-control-layers control",on:{click:function(t){return e.toggleCaption()}}},[t("v-icon",[e._v(" mdi-closed-caption ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.settings,expression:"settings"}],staticClass:"expand-control",attrs:{position:"topleft"}},[t("div",{staticClass:"leaflet-control-layers control",on:{click:function(t){return e.toggleExpand()}}},[t("v-icon",[e._v(" "+e._s(e.isExpanded?"mdi-fullscreen-exit":"mdi-fullscreen")+" ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.settings,expression:"settings"}],staticClass:"logout-control",attrs:{position:"topleft"}},[t("div",{staticClass:"leaflet-control-layers control",on:{click:function(t){return e.logout()}}},[t("v-icon",[e._v(" mdi-logout ")])],1)])])]),t("Caption")],1)},we=[],xe=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.caption,expression:"caption"}],staticClass:"caption-control-content"},[t("div",{staticClass:"leaflet-control-layers control"},[t("div",{staticClass:"caption-menu-action",on:{click:function(t){return e.toggleCaption()}}},[t("v-icon",[e._v("mdi-close")])],1),t("div",{staticClass:"caption"},e._l(e.layers,(function(a){return t("div",{key:a.id},e._l(a.legend,(function(o,s){return t("div",{key:s},[a.legend[s].length&&"polygon"===s?t("div",{staticClass:"legend-item polygon"},["scale"===e.getLayerType(a).name?t("div",[t("div",{staticClass:"legend-layer-name"},[e._v(e._s(`${e.getLabel(a,e.$i18n.locale)} (${a.layerGroup["polygon"].length})`))]),e._l(a.legend["polygon"],(function(o,s){return t("div",{key:s,staticClass:"legend-layer-item"},[t("div",{staticClass:"legend-layer-item-icon",domProps:{innerHTML:e._s(e.getHexagon(a.style.texture.value,o.color))}}),t("div",{staticClass:"legend-layer-item-name"},[e._v(e._s(e.$t(o.name)))])])}))],2):e._e(),"hexagon"===e.getLayerType(a).name?t("div",[t("div",{staticClass:"legend-layer-item"},[t("div",{staticClass:"legend-layer-item-icon",domProps:{innerHTML:e._s(e.getHexagon(a.style.texture.value,e.getLayerType(a).color))}}),t("div",{staticClass:"legend-layer-name"},[e._v(e._s(`${e.getLabel(a,e.$i18n.locale)} (${a.layerGroup["polygon"].length})`))])])]):e._e()]):e._e(),a.legend[s].length&&"image_overlay"===s?t("div",{staticClass:"legend-item image-overlay"},["scale"===e.getLayerType(a).name?t("div",[t("div",{staticClass:"legend-layer-name"},[e._v(e._s(`${e.getLabel(a,e.$i18n.locale)} (${a.layerGroup["imageOverlay"].length})`))]),e._l(a.legend["image_overlay"],(function(a,o){return t("div",{key:o,staticClass:"legend-layer-item"},[t("div",{staticClass:"legend-layer-item-icon",domProps:{innerHTML:e._s(e.getCircle(a.color))}}),t("div",{staticClass:"legend-layer-name"},[e._v(e._s(e.$t(a.name)))])])}))],2):e._e(),"hexagon"===e.getLayerType(a).name?t("div",[t("div",{staticClass:"legend-layer-item"},[t("div",{staticClass:"legend-layer-item-icon",domProps:{innerHTML:e._s(e.getHexagon(a.style.texture.value,e.getLayerType(a).color))}}),t("div",{staticClass:"legend-layer-name"},[e._v(e._s(`${e.getLabel(a,e.$i18n.locale)} (${a.layerGroup["imageOverlay"].length})`))])])]):e._e()]):e._e(),a.legend[s].length&&"marker"===s?t("div",{staticClass:"legend-item marker"},e._l(a.legend["marker"],(function(o,s){return t("div",{key:s,staticClass:"legend-layer-item"},[t("div",{staticClass:"legend-layer-item-marker",domProps:{innerHTML:e._s(e.getIcon(o.icon))}}),t("div",{staticClass:"legend-layer-name"},[e._v(e._s(`${e.getLabel(a,e.$i18n.locale)} (${a.layerGroup["marker"].length})`))])])})),0):e._e()])})),0)})),0)])])},$e=[],Oe={name:"Caption",data(){return{}},methods:{toggleCaption(){const e=this.$store.getters.mobile;Object(l["u"])("caption",!e.toggle.caption)},getLabel(e,t){return Object(l["k"])(e,t)},getLayerType(e){const t=e.style.types.find(e=>e.value);return t||{name:"scale"}},getIcon(e){return`\n                <img src="${a("67f7")("./"+e)}" width="15px" height="15px"></img>\n            `},getCircle(e){return`<svg height="18" width="18">\n                        <circle cx="10" cy="10" r="5" stroke="white" stroke-width="1" fill="${e}" />\n                    </svg>`},getHexagon(e,t){switch(e){case"horizontal":return`<svg width="15" height="17" xmlns="http://www.w3.org/2000/svg">\n                                <g>\n                                    <path stroke="#333" id="svg_1" d="m7.519513,-0.000008l7.352849,3.958512l0,7.917025l-7.352849,3.958512l-7.352849,-3.958512l0,-7.917025l7.352849,-3.958512z" fill="${t}" opacity="1"></path>\n                                    <rect id="svg_17" height="1.5" width="11" y="2" x="2" fill="#000"></rect>\n                                    <rect id="svg_14" height="1.5" width="15" y="5" x="0" fill="#000"></rect>\n                                    <rect id="svg_15" height="1.5" width="15" y="8.3" x="0" fill="#000"></rect>\n                                    <rect id="svg_16" height="1.5" width="11" y="11.5" x="2" fill="#000"></rect>\n                                </g>\n                            </svg>`;case"vertical":return`<svg width="15" height="17" xmlns="http://www.w3.org/2000/svg">\n                                <g>\n                                    <path stroke="#333" id="svg_1" d="m7.519513,-0.000008l7.352849,3.958512l0,7.917025l-7.352849,3.958512l-7.352849,-3.958512l0,-7.917025l7.352849,-3.958512z" fill="${t}" opacity="1"></path>\n                                    <rect id="svg_17" height="15" width="1.5" y="1" x="1.7" fill="#000"></rect>\n                                    <rect id="svg_14" height="15" width="1.5" y="0" x="5.1" fill="#000"></rect>\n                                    <rect id="svg_15" height="15" width="1.5" y="0" x="8.6" fill="#000"></rect>\n                                    <rect id="svg_16" height="15" width="1.5" y="1" x="12" fill="#000"></rect>\n                                </g>\n                            </svg>`;default:return`<svg width="15" height="17" xmlns="http://www.w3.org/2000/svg">\n                                <g>\n                                    <path stroke="#333" id="svg_1" d="m7.519513,-0.000008l7.352849,3.958512l0,7.917025l-7.352849,3.958512l-7.352849,-3.958512l0,-7.917025l7.352849,-3.958512z" fill="${t}" opacity="1"></path>\n                                </g>\n                            </svg>`}}},computed:{caption(){const e=this.$store.getters.mobile;return e.toggle.caption},layers(){const e=this.$store.getters.layers,t=Object.assign([],e),a=[];return t.map(e=>{e.layers.map(e=>{const{extra_props:t}=e.style;t&&t.mobile&&e.selected&&a.push(e)})}),a}}},Ce=Oe,Le=(a("20a9"),Object(_["a"])(Ce,xe,$e,!1,null,null,null)),Fe=Le.exports,Se={name:"CustomControl",props:["map","goToInitialLocation"],components:{Caption:Fe},methods:{toggleCaption(){const e=this.$store.getters.mobile,t=e.toggle.caption;Object(l["u"])("caption",!t)},toggleSettings(){const e=this.$store.getters.mobile,t=e.toggle.settings;Object(l["u"])("settings",!t)},toggleFeature(){const e=this.$store.getters.mobile,t=e.toggle.feature,a=this.$store.getters.layers;a.map(t=>{t.layers.map(t=>{const{extra_props:a,style:o}=t;if(o.extra_props&&o.extra_props.mobile&&"marker"===o.extra_props.type){const a={type:"CREATE",layer:t,feature:null};this.$store.dispatch("updateMobile",{...e,draw:a})}})}),Object(l["u"])("feature",!t)},toggleExpand(){const e=this.$store.getters.mobile,t=e.toggle.fullscreen;var a=document.getElementById("app");t?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),Object(l["u"])("fullscreen",!1)):(a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.webkitEnterFullscreen?a.webkitEnterFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen(),Object(l["u"])("fullscreen",!0))},showCaption(){},logout(){sessionStorage.clear(),localStorage.clear(),this.$router.replace("/")}},computed:{settings(){const e=this.$store.getters.mobile;return e.toggle.settings},isExpanded(){const e=this.$store.getters.mobile;return e.toggle.fullscreen}}},je=Se,Me=(a("6670"),Object(_["a"])(je,ke,we,!1,null,null,null)),Ee=Me.exports,Ie=function(){var e=this,t=e._self._c;return t("v-dialog",{staticClass:"popup",attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",scrollable:""},model:{value:e.showPopup,callback:function(t){e.showPopup=t},expression:"showPopup"}},[t("div",{staticClass:"popup-content"},[t("div",{staticClass:"popup-header"},[e._v(" POPUP "),t("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.showPopup=!1}}},[t("v-icon",[e._v("mdi-close")])],1)],1),t("div",{staticClass:"popup-body"},[e._v(" graficos aqui ")])])])},Ae=[],De={name:"Popup",props:["showPopup","close","data"],mounted(){console.log(this.data);const e=this.$store.getters.map,t=e.date;let a=t[0],o=t[1];const{idLayer:s,name:n}=this.data;Object(l["b"])("features",{id_layer:s,list_ids_cat:"",dt_start:a,dt_end:o,hexcode:n})}},Pe=De,Ne=Object(_["a"])(Pe,Ie,Ae,!1,null,null,null),Te=Ne.exports,Re=function(){var e=this,t=e._self._c;return t("div",{staticClass:"filters-control",attrs:{id:"filters-control"}},e._l(e.selectedLayers,(function(a){return t("div",{key:a.id,staticStyle:{display:"contents"}},[t("div",{staticStyle:{display:"contents"}},e._l(a.filters,(function(e,a){return t("div",{key:a,staticClass:"control"})})),0)])})),0)},Ge=[],ze={name:"Filters",props:["loadFeatures"],data(){return{swiper:null,atendimentos:["Furto","Contra a Vida","Contra a Pessoa"],turnos:["Madrugada","Manhã","Tarde","Noite"],swiperOption:{slidesPerView:1,slidesPerGroup:1,spaceBetween:20,loop:!0,loopFillGroupWithBlank:!1,grabCursor:!0,centeredSlides:!0,pagination:{clickable:!0},keyboard:{enabled:!0},mousewheel:!0,zoom:!0,effect:"fade",navigation:{prevEl:".swiper-button-prev-unique",nextEl:".swiper-button-next-unique"}}}},mounted(){document.getElementById("filters-control")},methods:{search(){setTimeout(()=>{this.loadFeatures()},200)},clickIcon(e){let t=document.getElementById("icon-"+e);t.click(),this.loadFeatures()},getFilterItem(e,t,a){const o=this.$store.getters.map,s=Object.assign({},o.menu);let n=null;return Object.values(s).map(o=>{o.data.map(o=>{o.selected&&o.id===a&&(49!==o.id?o.filters.map((a,o)=>{o===e&&(n=a.items[t])}):o.filters.map((a,o)=>{o===e&&(n=a.mobileItems[t])}))})}),n},selectFilterItem(e){if(!e.selected)return e.selected=!0;e.selected=!1},getClickedSlide(e,t,a){let o=parseInt(e.target.getAttribute("index")),s=this.getFilterItem(t,o,a);s&&this.selectFilterItem(s)},getLayerFilters(e){return e.filters}},computed:{selectedLayers(){const e=this.$store.getters.map,t=Object.assign({},e.menu),a=[];return Object.values(t).map(e=>{e.data.map(e=>{e.selected&&a.push(e)})}),a}}},qe=ze,Ue=(a("858f"),Object(_["a"])(qe,Re,Ge,!1,null,null,null)),Ye=Ue.exports,Be=function(){var e=this,t=e._self._c;return t("div",{staticClass:"filters-control",attrs:{id:"filters-control"}},e._l(e.selectedLayers,(function(a){return t("div",{key:a.id},e._l(a.filters,(function(a,o){return t("div",{key:o,staticStyle:{"max-width":"300px",width:"300px"}},[t("v-select",{attrs:{items:a.mobileItems,"item-value":"text",chips:"",label:a.type,multiple:"",solo:""},on:{change:function(t){return e.loadFeatures()}},model:{value:a.values,callback:function(t){e.$set(a,"values",t)},expression:"filter.values"}})],1)})),0)})),0)},He=[],Je={name:"SelectedFilters",props:["loadFeatures"],data(){return{}},computed:{selectedLayers(){const e=this.$store.getters.layers,t=Object.assign([],e),a=[];return t.map(e=>{e.layers.map(e=>{const{extra_props:t}=e.style;t&&t.mobile&&"marker"!=t.type&&e.selected&&a.push(e)})}),a}}},Ve=Je,Ze=Object(_["a"])(Ve,Be,He,!1,null,null,null),Ke=Ze.exports,We=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.feature,expression:"feature"}],staticClass:"feature-creation-control-content"},[t("div",{staticClass:"leaflet-control-layers control"},[t("div",{staticClass:"feature-menu-action",on:{click:function(t){return e.toggleFeature()}}},[t("v-icon",[e._v("mdi-close")])],1),e.draw.layer?t("div",{staticClass:"feature-creation"},[e._l(e.draw.layer.filters,(function(a){return t("div",{key:a.id},[a.visible?t("div",{staticClass:"field-item"},["CREATE"===e.draw.type?t("div",[["text","password","number"].includes(a.type)?t("div",[t("v-text-field",{attrs:{name:a.name,label:e.getLabel(a,e.$i18n.locale),type:a.type,outlined:"",dense:"",autocomplete:"off"},model:{value:a.key,callback:function(t){e.$set(a,"key",t)},expression:"field.key"}})],1):e._e(),"textarea"===a.type?t("div",[t("v-textarea",{attrs:{label:e.getLabel(a,e.$i18n.locale),solo:"",name:a.name,"no-resize":"",outlined:"",autocomplete:"off"},model:{value:a.key,callback:function(t){e.$set(a,"key",t)},expression:"field.key"}})],1):e._e(),"boolean"===a.type?t("div",[t("v-switch",{attrs:{label:e.getLabel(a,e.$i18n.locale)},model:{value:a.key,callback:function(t){e.$set(a,"key",t)},expression:"field.key"}})],1):e._e(),"date"===a.type?t("div",[t("v-date-picker",{attrs:{range:""},model:{value:a.key,callback:function(t){e.$set(a,"key",t)},expression:"field.key"}})],1):e._e(),"image"===a.type?t("div",[t("v-row",{staticClass:"align-center"},[t("v-col",{attrs:{cols:"9"}},[t("v-file-input",{attrs:{"truncate-length":50,label:e.getLabel(a,e.$i18n.locale)},on:{change:t=>e.onChangeFile(t)},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),t("v-col",{attrs:{cols:"1"}},[t("v-btn",{staticClass:"mx-auto",attrs:{fab:"",small:"",color:"teal",disabled:e.loading},on:{click:function(t){return e.getFileURL(a)}}},[e.loading?t("v-progress-circular",{attrs:{indeterminate:"",color:"teal"}}):t("v-icon",[e._v("mdi-upload")])],1)],1)],1)],1):e._e()]):e._e()]):e._e()])})),t("div",{staticClass:"actions"},[t("v-btn",{attrs:{color:"red",filled:"",ripple:"",width:"110",small:""},on:{click:function(t){return e.deleteMarker()}}},[e._v(" "+e._s(e.$t("dialog_btn_delete"))+" ")]),t("v-btn",{attrs:{color:"green",filled:"",ripple:"",width:"110",small:""},on:{click:function(t){return e.drawPointInMap()}}},[e._v(" "+e._s("EDIT"===e.draw.type?e.$t("dialog_btn_edit"):e.$t("dialog_btn_draw"))+" ")])],1)],2):e._e()])])},Qe=[],Xe=a("bbd2"),et=Xe["a"],tt=(a("7735"),Object(_["a"])(et,We,Qe,!1,null,null,null)),at=tt.exports,ot=(a("48ec"),{name:"Map",components:{NavBar:ee,Loading:Y,Snackbar:re,LMap:le["a"],LTileLayer:ce["a"],LControlZoom:pe["a"],LControlLayers:de["a"],LControl:ue["a"],LayerMenu:C,LGeoJson:me["a"],DatePicker:T,LPolygon:fe["a"],LImageOverlay:ge["a"],LLayerGroup:he["a"],LMarker:ve["a"],LIcon:ye["a"],LCircle:be["a"],CustomControl:Ee,Popup:Te,LPopup:_e["a"],Filters:Ye,SelectedFilters:Ke,LMarkerCluster:ie,FeatureCreation:at},data(){return{popup:{open:!1,data:null,charts:[]},title:"map",loading:!1,features:[],map:{mapRef:"map",zoom:Object(l["n"])(),centerMapCoords:Object(l["l"])(),options:{zoomControl:!1,attributionControl:!1},geojsons:[],layerGroups:[],tileLayers:[{name:"ROADMAP",label:"Detalhado",visible:!0,origins:{SC:"Roadmap",CT:"Roadmap"},url:"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",options:{maxZoom:18,attribution:"Google Maps",subdomains:["mt0","mt1","mt2","mt3"]}},{name:"DARK",label:"Escuro",origins:{SC:"Escuro",CT:"Dark"},url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png?api_key=39637672-75ae-4744-80c2-5d63301f5b3f",options:{maxZoom:18,attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}}]}}},beforeCreate(){p.a.defaults.headers.common["Authorization"]=localStorage.getItem("crimeradarToken")},mounted(){const e=this.$refs.map.mapObject;window._map=e,e.on(V.a.Draw.Event.CREATED,t=>{const a=new V.a.FeatureGroup;e.addLayer(a);let o=t.layerType,s=t.layer,n=s.getLatLng();const{lng:r,lat:i}=n;this.$store.getters.mobile;if("marker"===o){const e=[i,r,0],t=this.$store.getters.mobile,a=t.draw.feature,o=Object.assign({},a);o.geometry=e,o.type="MARKER",s.bindPopup(o.popup);const{feature:n,type:l}=t.draw;"CREATE"===l?this.$store.dispatch("updateMobile",{...t,draw:{...t.draw,feature:o}}).then(()=>{this.createMarkerFeature(o)}):console.log("request edit")}a.addLayer(s)}),this.loadGeojson()},methods:{async createMarkerFeature(e){this.loading=!0;const t={open:!0,color:"",text:"sending_data",timeout:2500,type:"warning"};this.$store.dispatch("updateSnackbar",t);let a=Object.assign({},this.$store.getters.mobile);const{layer_id:o}=e;let s=Object(l["b"])("feature");p.a.post(s,e).then(e=>{const{data:t,errors:s}=e.data;if(!Object(d["isEmpty"])(s))return this.loading=!1,Object(l["g"])(s);let n={layer_id:null,tenant_id:null,feature_collection_id:null,language:"pt",fields:[],properties:{},geometry:null,type:null,popup:null};this.$store.dispatch("updateMobile",{...a,draw:{type:"",layer:null,feature:n},toggle:{...a.toggle,feature:!1}});const r={open:!0,color:"",text:"success_create_interest_point",timeout:2500,type:"success"};this.$store.dispatch("updateSnackbar",r);const i=this.$store.getters.layers,c=Object.assign([],i);c.map(e=>{e.layers.map(e=>{e.id===o&&(e.selected=!0)})}),this.$store.dispatch("updateLayers",c)}).then(()=>this.loadFeatures()).catch(e=>{console.error(e),this.loading=!1;const t={open:!0,color:"",text:"error_create_interest_point",timeout:2500,type:"error"};this.$store.dispatch("updateSnackbar",t),Object(l["u"])("feature",!0)})},async loadGeojson(){const e=Object(l["h"])(),t=Object(l["c"])();!Object(d["isEmpty"])(e)&&t&&e.map(e=>{let a=`${t}/geojson/${e}.geojson`;var o={method:"GET",redirect:"follow"};fetch(a,o).then(e=>e.json()).then(e=>{let t=e;this.map.geojsons.push({data:t,options:{color:"#c4c4a6","stroke-width":"3","fill-opacity":.5}})}).catch(e=>{console.log(e),p.a.get("geojson/default.geojson").then(e=>{let t=e.data;this.map.geojsons.push({data:t,options:{color:"#c4c4a6","stroke-width":"3","fill-opacity":.5}})})})})},closeAll(){const e=this.$store.getters.menu;let t=Object.assign({},e);t={layers:!1,dates:!1,settings:!1},document.getElementById("date-map-control").style.bottom="35px",this.$store.dispatch("updateMenu",t)},getSelectedLayers(){return Object(l["o"])()},closePopup(){this.popup={open:!1,data:null,charts:[]}},openPopup(e){this.loading=!0;const t=this.$store.getters.map,a=t.date;let o=a[0],s=a[1];const{idLayer:n,name:r}=e;let i=Object(l["b"])("features",{id_layer:n,list_ids_cat:"",dt_start:o,dt_end:s,hexcode:r});p.a.get(i).then(t=>{const{charts:a}=t.data;a.map(e=>{const{chart_options:t}=e;"heatmap"===t.chart.type&&(t.xaxis.categories=["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"]),"donut"===t.chart.type&&delete t.responsive}),this.popup={open:!0,data:e,charts:a},this.loading=!1}).catch(e=>{console.error(e),this.loading=!1})},goToInitialLocation(){let e=this.map.centerMapCoords,t=this.map.zoom;this.$refs.map.mapObject.flyTo(e,t)},closeMenu(){const e=this.$store.getters.mobile;this.$store.dispatch("updateMobile",{...e,toggle:{layers:!1,dates:!1,settings:!1,fullscreen:!1,caption:!1,feature:!1}})},getDates(e){return 1===e.length&&(e[1]=e[0]),v()(e[0]).isAfter(e[1])&&(e=[e[1],e[0]]),e},async clearMapData(){if(Object(l["u"])("caption",!1),!Object(d["isEmpty"])(this.map.layerGroups)||this.loading)this.map.layerGroups=[];else{const e={open:!0,color:"",text:"no_info_to_remove",timeout:2500,type:"warn"};this.$store.dispatch("updateSnackbar",e)}},getLayerFilters(e){let t=[];return e.filters.map(e=>{e.values.map(a=>t.push(`filter[]=${e.name}|${a}`))}),t.join("&")},checkMapConfig(){const e=Object.assign([],this.$store.getters.layers),t=this.$store.getters.dates;let a=v()().format("yyyy-MM-DD");a=v()(a).subtract(1,"days").format("yyyy-MM-DD");let o=t[0];e.map(e=>{e.layers.map(e=>{const{extra_props:t}=e.style;if(e.selected=!1,v()(o).isAfter(a)){if(t&&t.mobile&&("icon"===t.type||"marker"===t.type)){e.selected=!0;let t=[o,o];this.$store.dispatch("updateDates",t)}}else t&&t.mobile&&"icon"!==t.type&&(e.selected=!0)})}),this.$store.dispatch("updateLayers",e)},async loadFeatures(){console.log("loading features..."),this.loading=!0,this.clearMapData().then(()=>this.closeMenu());const e=this.$store.getters.layers;let t=this.$store.getters.dates;if(Object(d["isEmpty"])(t)){const e={open:!0,color:"",text:"error_get_layers",timeout:2500,type:"error"};return this.$store.dispatch("updateSnackbar",e),void(this.loading=!1)}t=this.getDates(t);let a=t[0],o=t[1];this.checkMapConfig(),e.map(e=>{e.layers.map(e=>{const{id:t,selected:s,name:n,editable:r}=e;if(s){let s=Object(l["b"])(`layer/${t}/feature`);s+=this.getLayerFilters(e);let i={id_layer:t,dt_start:a,dt_end:o};p.a.get(s,{params:i}).then(a=>{const{data:o,errors:s}=a.data;if(!Object(d["isEmpty"])(s))return this.loading=!1,Object(l["g"])(s);const{features:i,items:c}=o;if(Object(d["isEmpty"])(i)){const e={open:!0,color:"",text:"no_features_founded",timeout:2500,type:"success"};return this.$store.dispatch("updateSnackbar",e),void(this.loading=!1)}let p={polygon:[],imageOverlay:[],marker:[],point:[]};i.map(async t=>{const a=await this.getFeature(t,e);Object(d["isEmpty"])(a.fields)||("POLYGON"===a.type?p.polygon.push(a):"IMAGE_OVERLAY"===a.type?p.imageOverlay.push(a):"MARKER"===a.type?p.marker.push(a):"POINT"===a.type&&p.point.push(a))});let u=0;Object.values(p).map(e=>u+=e.length);const m={id:t,name:n,featuresAmount:u,features:p,visible:!0,type:"overlay",editable:r};e.features=i,e.legend=c,e.layerGroup=p,this.map.layerGroups.push(m);this.map.layerGroups;this.loading=!1}).catch(e=>{console.log(e),this.loding=!1})}})})},hslToHex(e){let t=e.substring(e.indexOf("(")+1,e.indexOf(")")).replace(/%/g,""),[a,o,s]=t.split(",");s/=100;const n=o*Math.min(s,1-s)/100,r=e=>{const t=(e+a/30)%12,o=s-n*Math.max(Math.min(t-3,9-t,1),-1);return Math.round(255*o).toString(16).padStart(2,"0")};return`#${r(0)}${r(8)}${r(4)}`},async getFeature(e,t){const{id:o,name:s,properties:n,geometry:r,label:i,style:c,type:p,props:u,fields:m}=e;let f=s,g=this.$i18n.locale,h={id:o,name:s,text:f,geometry:r,idLayer:t.id,properties:n,styles:c,isOnEditableLayer:t.editable,fields:m,defaultStyle:c};switch(e.type){case"POLYGON":{const{color:e,fillColor:a,fillOpacity:o,opacity:s,weight:n}=c;let r=e,i=a;try{const e=t.style.types.find(e=>e.value);"hexagon"===e.name&&(r=e.color,i=e.color,h.styles={...h.styles,color:r,fillColor:i},h.defaultStyle={...h.defaultStyle,color:r,fillColor:i})}catch(v){console.error(v)}let l=[],d="",u=this.hslToHex(r);"HORIZONTAL"===t.style.texture.value?(l=[u,"#FFFFFF"],d=`<linearGradient id="layer-${t.id}-stripes-${u}" x1="0" y1="0" x2="0" y2="1">\n                                                <stop offset=0 stop-color=${l[0]} />\n                                                <stop offset=20% stop-color=${l[1]} />\n                                                <stop offset=20% stop-color=${l[0]} />\n                                                <stop offset=40% stop-color=${l[1]} />\n                                                <stop offset=40% stop-color=${l[0]} />\n                                                <stop offset=60% stop-color=${l[1]} />\n                                                <stop offset=60% stop-color=${l[0]} />\n                                                <stop offset=80% stop-color=${l[1]} />\n                                                <stop offset=80% stop-color=${l[0]} />                                                \n                                                <stop offset=100% stop-color=${l[1]} />\n                                                <stop offset=100% stop-color=${l[0]} />\n                                              </linearGradient>`):"VERTICAL"===t.style.texture.value&&(l=[u,"#FFFFFF"],d=`<linearGradient id="layer-${t.id}-stripes-${u}" x1="0" y1="0" x2="1" y2="0">\n                                                <stop offset=0 stop-color=${l[0]} />\n                                                <stop offset=20% stop-color=${l[1]} />\n                                                <stop offset=20% stop-color=${l[0]} />\n                                                <stop offset=40% stop-color=${l[1]} />\n                                                <stop offset=40% stop-color=${l[0]} />\n                                                <stop offset=60% stop-color=${l[1]} />\n                                                <stop offset=60% stop-color=${l[0]} />\n                                                <stop offset=80% stop-color=${l[1]} />\n                                                <stop offset=80% stop-color=${l[0]} />                                                \n                                                <stop offset=100% stop-color=${l[1]} />\n                                                <stop offset=100% stop-color=${l[0]} />\n                                              </linearGradient>`);try{const e=document.getElementById(`layer-${t.id}-stripes-${u}`);if("NONE"!==t.style.texture.value&&!e){let e=document.getElementsByTagName("svg")[0],a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.classList.add("layer-"+t.id),a.insertAdjacentHTML("afterbegin",d),e.appendChild(a)}}catch(v){console.log(v)}let m={...h,color:r,fillColor:"NONE"!==t.style.texture.value?`url(#layer-${t.id}-stripes-${u})`:i,fillOpacity:o,opacity:s,type:p||"POLYGON",weight:n};return m.defaultStyle={color:m.color,fillColor:m.fillColor,fillOpacity:m.fillOpacity,opacity:m.opacity,weight:m.weight},m._polygon=m,m}case"IMAGE_OVERLAY":{const{color:e,fillColor:a,fillOpacity:o,opacity:s,weight:n}=c;let i=e,p=a;const u=m.find(e=>null!==e.extra_props);if(Object(d["isEmpty"])(m)||!u||!u.extra_props||!u.extra_props.image){let e=Object(l["f"])();e=e.replace("[width]",350),e=e.replace("[height]",350),e=e.replace("[color]",i),e=e.replace("[opacity]",s);let t=btoa(e),a="data:image/svg+xml;base64,"+t;return{...h,bounds:r,url:a,opacity:s,type:"IMAGE_OVERLAY",interactive:!0,zIndex:9999,imageOverlayType:null}}try{const e=t.style.types.find(e=>e.value);"hexagon"===e.name&&(i=e.color,p=e.color,h.styles={...h.styles,color:i,fillColor:p},h.defaultStyle={...h.defaultStyle,color:i,fillColor:p})}catch(v){console.error(v)}let f="",g=this.hslToHex(i);"HORIZONTAL"===t.style.texture.value?f=Object(l["i"])(t,g,"HORIZONTAL"):"VERTICAL"===t.style.texture.value&&(f=Object(l["i"])(t,g,"VERTICAL"));const{key:y}=u;y.toUpperCase();Object.prototype.hasOwnProperty.call(this.downloadedImagesUrls,y);let b=null;b=await Object(l["j"])(this.downloadedImagesUrls[y],i,s);try{const e=document.getElementById(`layer-${t.id}-stripes-${g}`);if("NONE"!==t.style.texture.value&&!e){let e=b,a=(new DOMParser).parseFromString(e,"image/svg+xml").firstElementChild,o=document.createElementNS("http://www.w3.org/2000/svg","defs");o.classList.add("layer-"+t.id),o.insertAdjacentHTML("afterbegin",f),a.appendChild(o),a.getElementsByTagName("g")[0].setAttribute("fill",`url(#layer-${t.id}-stripes-${g})`),b=a.outerHTML.trim()}}catch(v){console.log(v)}let _=btoa(b),k="data:image/svg+xml;base64,"+_,w={...h,bounds:r,url:k,opacity:s,type:"IMAGE_OVERLAY",interactive:!0,zIndex:9999,imageOverlayType:y};return w}case"MARKER":{const{id:e,image:o}=n,{icon:s}=c;let r="";t.filters.map(e=>{const t=m.find(t=>t.field_config_id===e.id);if(!t)return r+="";let a=e.label&&e.label[g]?e.label[g]:e.name,o="";"image"===e.type?o+=`${a}: <a href='${t.key}' target='_blank'>${t.key}</a> <br />`:o+=`${a}: ${t.key} <br />`,r+=o});let i=a("67f7")("./"+s);o&&!Object(d["isEmpty"])(o)&&(i=o);let l={...h,type:p||"MARKER",iconUrl:i,iconRetinaUrl:i,iconSize:[32,32],iconAnchor:[16,37],popupAnchor:[0,-30],text:r};return l}case"POINT":{const{color:e,fillColor:t,fillOpacity:a,opacity:o,stroke:s,radius:n}=c;let r={...h,type:p||"POINT",color:e,fillColor:t,fillOpacity:a,radius:3,stroke:!1};return r}default:return}},isLayerSelected(e){let t=!1;return Object.keys(e).map(a=>{"types"==a&&Object.values(e[a]).map(e=>{e.value&&(t=!0)})}),t},async reset(){window.mapmanager.clearData().then(()=>{const e={open:!0,color:"",text:"reset_confi",timeout:2500,type:"success"};this.$store.dispatch("updateSnackbar",e),this.loading=!1})},getFilterIds(e){let t=[];return e.map(e=>{e.tags.map(e=>{t.push(e.id)})}),t}},computed:{menu(){return this.$store.getters.menu},dates(){const e=this.$store.getters.dates;let t=v()(e[0]).format("DD/MM/YYYY"),a=v()(e[1]).format("DD/MM/YYYY");return t+" ~ "+a}}}),st=ot,nt=(a("2e58"),Object(_["a"])(st,B,H,!1,null,null,null)),rt=nt.exports,it={name:"LoginPage",components:{Loading:Y},data(){return{loading:!1,snackbar:{open:!1,color:"",text:"",timeout:2500},inputs:[{name:"email",label:"email",type:"text",color:"#FFF",required:!0,value:"",appendIcon:{hasIcon:!1,iconOn:"",iconOff:""},counter:50,rules:[e=>!!e||"O Email é obrigatório",e=>/.+@.+\..+/.test(e)||"O email deve ser válido"]},{name:"password",label:"password",type:"password",color:"#FFF",required:!0,show:!1,value:"",counter:20,appendIcon:{hasIcon:!0,iconOn:"mdi-eye",iconOff:"mdi-eye-off"},rules:[e=>!!e||"A Senha é obrigatória",e=>e&&e.length<=15||"A senha deve ter no máximo 15 caracteres"]}]}},mounted(){},methods:{forgotPassword(){this.loading=!0;const e=this.inputs[0];if(""===e.value){this.loading=!1;const e={open:!0,color:"",text:"no_email_provided",timeout:2500,type:"warning"};return this.$store.dispatch("updateSnackbar",e)}i["a"].auth().sendPasswordResetEmail(e.value).then(()=>{this.loading=!1;const e={open:!0,color:"",text:"success_reset_password",timeout:2500,type:"success"};return this.$store.dispatch("updateSnackbar",e)}).catch(e=>{this.loading=!1;const t={open:!0,color:"",text:"error_reset_password",timeout:2500,type:"error"};return this.$store.dispatch("updateSnackbar",t)})},goFullscreen(){var e=document.getElementById("app");e.requestFullscreen?(e.requestFullscreen(),Object(l["u"])("fullscreen",!0)):e.mozRequestFullScreen?(e.mozRequestFullScreen(),Object(l["u"])("fullscreen",!0)):e.webkitRequestFullscreen?(e.webkitRequestFullscreen(),Object(l["u"])("fullscreen",!0)):e.webkitEnterFullscreen?(e.webkitEnterFullscreen(),Object(l["u"])("fullscreen",!0)):e.msRequestFullscreen&&(e.msRequestFullscreen(),Object(l["u"])("fullscreen",!0))},login(){this.goFullscreen(),this.loading=!0;const e=this.inputs[0].value,t=this.inputs[1].value;i["a"].auth().signInWithEmailAndPassword(e,t).then(async e=>{if(e.error)return this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_firebase",timeout:2500,type:"error"});const{user:t}=e,a=await t.getIdToken();let o=Object(l["b"])("auth/token");const s={email:t.email,access_token:a,tenant_id:"1"};p.a.post(o,s).then(e=>{const{data:t,errors:a}=e.data,{active:o,tenants:s,email:n,token:r}=t;if(!Object(d["isEmpty"])(a))return this.loading=!1,Object(l["g"])(a);if(Object(d["isEmpty"])(t))return this.loading=!1,this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_user_not_found",timeout:2500,type:"error"});p.a.defaults.headers.common["Authorization"]=r.access_token;const i=s.find(e=>"1"==e);if(!i)return this.loading=!1,this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_user_without_permission",timeout:2500,type:"error"});if(!o)return this.loading=!1,this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_user_not_active",timeout:2500,type:"error"});{let e=Object(l["b"])("auth/tenant/1/token");p.a.post(e).then(e=>{const{data:{email:t,name:a,roles:o,token:{scope:n,access_token:r}}}=e.data;localStorage.setItem("crimeradarToken",r),sessionStorage.setItem("user",JSON.stringify({name:a,roles:o,scope:n,tenants:s,email:t})),this.loading=!1,this.$router.push({name:"map"}).catch(e=>console.log(e))}).catch(e=>(console.log(e),this.loading=!1,this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_api",timeout:2500,type:"error"})))}}).catch(e=>(this.loading=!1,this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_api",timeout:2500,type:"error"})))}).catch(e=>(this.loading=!1,this.$store.dispatch("updateSnackbar",{open:!0,color:"",text:"error_firebase",timeout:2500,type:"error"})))}},computed:{getVersion:()=>{const e="1.0";return"v."+e}}},lt=it,ct=(a("7366"),Object(_["a"])(lt,n,r,!1,null,null,null)),pt=ct.exports,dt=function(){var e=this,t=e._self._c;return t("main",[t("div",{staticClass:"mappage"},[t("Map")],1)])},ut=[],mt={name:"MapPage",components:{Map:rt},data(){return{menu:"Map"}}},ft=mt,gt=(a("2e3a"),Object(_["a"])(ft,dt,ut,!1,null,null,null)),ht=gt.exports;o["default"].use(s["a"]);const vt=new s["a"]({mode:"history",base:"/",routes:[{path:"*",redirect:"/"},{path:"/",name:"login",component:pt},{path:"/map",name:"map",component:ht}]});vt.beforeEach((e,t,a)=>{const o=i["a"].auth().currentUser,s=e.matched.some(e=>e.meta.requiresAuth);s&&!o?a("login"):a()});t["a"]=vt},da87:function(e,t,a){},ddb8:function(e,t,a){"use strict";a("acfa");let o=null;t["a"]=o},e34f:function(e,t,a){},e6aa:function(e,t,a){},e95d:function(e,t,a){"use strict";var o=function(){var e=this,t=e._self._c;return t("v-app",{attrs:{id:"app"}},[t("router-view"),t("Snackbar")],1)},s=[],n=a("fbad"),r={name:"App",components:{Snackbar:n["a"]},data(){return{}}},i=r,l=(a("3e7c"),a("2877")),c=Object(l["a"])(i,o,s,!1,null,null,null);t["a"]=c.exports},eba6:function(e,t,a){"use strict";a("90ba")},ed08:function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"s",(function(){return d})),a.d(t,"o",(function(){return u})),a.d(t,"p",(function(){return m})),a.d(t,"q",(function(){return f})),a.d(t,"r",(function(){return g})),a.d(t,"c",(function(){return h})),a.d(t,"l",(function(){return v})),a.d(t,"h",(function(){return y})),a.d(t,"n",(function(){return b})),a.d(t,"m",(function(){return _})),a.d(t,"t",(function(){return k})),a.d(t,"d",(function(){return w})),a.d(t,"a",(function(){return x})),a.d(t,"g",(function(){return $})),a.d(t,"e",(function(){return C})),a.d(t,"k",(function(){return L})),a.d(t,"u",(function(){return F})),a.d(t,"i",(function(){return S})),a.d(t,"f",(function(){return j})),a.d(t,"j",(function(){return M}));a("14d9");var o=a("bc3a"),s=a.n(o),n=a("2ef0"),r=a("07a4"),i=a("fa4b"),l=a("260b"),c=a("0692");a("ea7b");const p=(e,t={})=>{const a="http://127.0.0.1:8000/api/v1",o="development";let s=`${a}/${e}`;return Object(n["isEmpty"])(t)||Object.keys(t).map((e,a)=>{const o=t[e];s+=0==a?`?${e}=${o}`:`&${e}=${o}`}),"production"!==o&&console.info("%cRequesting: "+s,"color: #000; font-style: italic; background-color: #643b9f; padding: 2px"),s},d=()=>{const e=window.navigator.userAgent,t=/(Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone)/i;return!!e.match(t)},u=()=>{const e=r["a"].getters.layers,t=Object.assign([],e),a=[];return t.map(e=>{e.layers.map(e=>{e.selected&&a.push(e)})}),a},m=()=>{const e=JSON.parse(sessionStorage.getItem("user"));return e},f=()=>{const e=JSON.parse(sessionStorage.getItem("user"));return e.email||""},g=()=>{let e=JSON.parse(sessionStorage.getItem("user")),t=[];return e.scope&&e.scope.map(e=>t.push(e)),t},h=()=>"",v=()=>[-8,-38],y=()=>["pernambuco"],b=()=>6.5,_=()=>[{name:"DARK",label:"en"===c["a"].locale?"Dark":"Escuro",visible:!0,url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png?api_key=39637672-75ae-4744-80c2-5d63301f5b3f",options:{maxZoom:18,attribution:"Stadia"}},{name:"ROADMAP",label:"en"===c["a"].locale?"Detailed":"Detalhado",visible:!0,url:"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",options:{maxZoom:18,attribution:"Google Maps",subdomains:["mt0","mt1","mt2","mt3"]}}],k=(e,t,a=30)=>{const o=24*a*60*60;document.cookie=`${e}=${t||""};Max-Age=${o};path=/`},w=e=>{const t="; "+document.cookie,a=t.split(`; ${e}=`);if(2===a.length)return a.pop().split(";").shift()},x=()=>{localStorage.clear(),sessionStorage.clear()},$=e=>{const{code:t,error_code:a,message:o}=e[0];console.error(`\n    code: ${t}\n    error_code: ${a}\n    message: ${o}\n  `);const s={open:!0,color:"",text:o,timeout:2500,type:"error"};r["a"].dispatch("updateSnackbar",s),498===t&&O()},O=async()=>{try{let e=p("auth/token");if(!sessionStorage.getItem("user")||!JSON.parse(sessionStorage.getItem("user")).email)return i["a"].push("/");const t=await l["a"].auth().currentUser.getIdToken(!0),a={email:JSON.parse(sessionStorage.getItem("user")).email,access_token:t,tenant_id:"1"};s.a.post(e,a).then(e=>{r["a"].dispatch("updateSnackbar",{open:!0,color:"",text:"auth",timeout:2500,type:"warning"});const{data:t,errors:a}=e.data;if(!Object(n["isEmpty"])(a))return $(a);const{active:o,tenants:l,email:c,token:d}=t;s.a.defaults.headers.common["Authorization"]=d.access_token;const u=l.find(e=>"1"==e);if(!u)return r["a"].dispatch("updateSnackbar",{open:!0,color:"",text:"error_user_without_permission",timeout:2500,type:"error"});if(o){let e=p("auth/tenant/1/token");s.a.post(e).then(e=>{r["a"].dispatch("updateSnackbar",{open:!0,color:"",text:"success_auth",timeout:2500,type:"success"});const{data:{email:t,name:a,roles:o,token:{scope:s,access_token:n,feature_collections:c,tenant_id:p}}}=e.data;localStorage.setItem("crimeradarToken",n),sessionStorage.setItem("featureCollections",JSON.stringify(c)),sessionStorage.setItem("tenantId",p),sessionStorage.setItem("user",JSON.stringify({name:a,roles:o,scope:s,tenants:l,email:t})),i["a"].go({name:"map"}).catch(e=>console.log(e))}).catch(e=>(console.log(e),r["a"].dispatch("updateSnackbar",{open:!0,color:"",text:"error_api",timeout:2500,type:"error"})))}})}catch(e){console.error(e),i["a"].push("/").catch(e=>console.error(e))}},C=()=>({colorScale:{point:{key1:{color:"hsl(9, 62%, 49%)",fillColor:"hsl(255, 0%, 0%)",opacity:.6,fillOpacity:.6,radius:3,stroke:!1},key2:{color:"hsl(9, 62%, 49%)",fillColor:"hsl(255, 0%, 0%)",opacity:.6,fillOpacity:.6,radius:3,stroke:!1}},polygon:["hsl(240, 100%, 50%)","hsl(180, 100%, 50%)","hsl(120, 100%, 50%)","hsl(60, 100%, 50%)","hsl(0, 100%, 50%)"]},color:"#FFFFFF",types:[{name:"scale",value:!0,icon:"mdi-format-color-fill",label:"scale"},{name:"hexagon",value:!1,icon:"mdi-hexagon",label:"hexagon"},{name:"icon",value:!1,icon:"mdi-star-circle",label:"icon"},{name:"marker",value:!1,icon:"mdi-map-marker",label:"marker"},{name:"point",value:!1,icon:"mdi-brightness-1",label:"point"}],texture:{value:"NONE",options:["NONE","HORIZONTAL","VERTICAL"]}}),L=(e,t)=>e.label&&e.label[t]?e.label[t]:e.name||"--",F=(e,t)=>{const a=r["a"].getters.mobile;Object.keys(a.toggle).map(o=>{o===e&&(a.toggle[o]=t)}),r["a"].dispatch("updateMobile",a)},S=(e,t,a)=>{let o=[t,"#FFFFFF"];return"HORIZONTAL"===a?`\n        <linearGradient id="layer-${e.id}-stripes-${t}" x1="0" y1="0" x2="0" y2="1">\n          <stop offset=0 stop-color=${o[0]} />\n          <stop offset=20% stop-color=${o[1]} />\n          <stop offset=20% stop-color=${o[0]} />\n          <stop offset=40% stop-color=${o[1]} />\n          <stop offset=40% stop-color=${o[0]} />\n          <stop offset=60% stop-color=${o[1]} />\n          <stop offset=60% stop-color=${o[0]} />\n          <stop offset=80% stop-color=${o[1]} />\n          <stop offset=80% stop-color=${o[0]} />                                                \n          <stop offset=100% stop-color=${o[1]} />\n          <stop offset=100% stop-color=${o[0]} />\n        </linearGradient>\n    `:"VERTICAL"===a?`<linearGradient id="layer-${e.id}-stripes-${t}" x1="0" y1="0" x2="1" y2="0">\n              <stop offset=0 stop-color=${o[0]} />\n              <stop offset=20% stop-color=${o[1]} />\n              <stop offset=20% stop-color=${o[0]} />\n              <stop offset=40% stop-color=${o[1]} />\n              <stop offset=40% stop-color=${o[0]} />\n              <stop offset=60% stop-color=${o[1]} />\n              <stop offset=60% stop-color=${o[0]} />\n              <stop offset=80% stop-color=${o[1]} />\n              <stop offset=80% stop-color=${o[0]} />                                                \n              <stop offset=100% stop-color=${o[1]} />\n              <stop offset=100% stop-color=${o[0]} />\n            </linearGradient>`:""},j=()=>'<svg \n\tversion="1.0" xmlns="http://www.w3.org/2000/svg"\n    width="[width]" height="[height]" viewBox="0 0 301 350"\n    preserveAspectRatio="xMidYMid meet"\n>\n    <metadata>\n        written by Rodrigo Werneck 2020-2021\n    </metadata>\n\n    <g \n        transform="translate(0.000000,350.000000) scale(0.100000,-0.100000)"\n        fill="[color]" stroke="none" \n        opacity="[opacity]"\n    >\n        <path \n            d="M733 3058 l-732 -423 0 -885 0 -885 734 -424 c404 -233 735 -428 735\n                -432 0 -14 42 -10 54 5 10 12 1435 839 1470 852 15 6 16 78 16 883 l0 877 -32\n\t\t        16 c-18 9 -352 201 -743 427 -505 293 -719 411 -740 411 -21 0 -241 -122 -762\n                -422z m1387 -578 c0 -7 -212 -10 -615 -10 -403 0 -615 3 -615 10 0 7 212 10\n               615 10 403 0 615 -3 615 -10z m12 -59 c14 -7 34 -28 44 -46 17 -31 17 -64 5\n              -600 -13 -613 -12 -605 -68 -642 -25 -17 -70 -18 -608 -18 -538 0 -583 1 -608\n              18 -56 37 -55 29 -68 642 -12 539 -12 569 5 600 19 34 48 51 101 58 17 3 287\n              4 600 3 461 -1 575 -4 597 -15z m-1352 -656 c0 -390 -3 -595 -10 -595 -7 0\n              -10 205 -10 595 0 390 3 595 10 595 7 0 10 -205 10 -595z m1480 0 c0 -522 -2\n              -595 -15 -595 -13 0 -15 73 -15 595 0 522 2 595 15 595 13 0 15 -73 15 -595z"\n        />\n        <path d="M940 2341 c-15 -4 -32 -21 -42 -41 -16 -30 -18 -66 -18 -276 0 -132\n              -5 -301 -12 -375 -7 -73 -12 -200 -12 -281 -1 -136 1 -149 20 -168 20 -21 26\n              -21 625 -21 332 0 612 3 621 6 32 13 41 70 34 225 -3 80 -10 192 -16 250 -5\n              58 -9 218 -10 355 0 218 -2 255 -18 285 -10 20 -27 37 -42 41 -33 9 -1097 9\n              -1130 0z m671 -109 c22 -18 22 -23 20 -188 -3 -212 -14 -302 -45 -364 -29 -58\n              -27 -120 4 -120 10 0 20 5 22 12 3 7 9 8 18 3 19 -12 6 -243 -15 -265 -12 -11\n              -39 -15 -110 -15 -71 0 -98 4 -110 15 -21 22 -34 253 -15 265 9 5 15 4 18 -3\n              2 -7 12 -12 22 -12 31 0 33 62 4 120 -31 62 -42 152 -45 364 -3 208 -4 206\n              126 206 66 0 88 -4 106 -18z"\n        />\n        <path d="M1443 2224 c-34 -8 -44 -28 -37 -72 8 -54 17 -66 40 -55 21 10 100 9\n              126 -2 17 -7 22 2 33 66 5 25 2 39 -9 48 -16 13 -115 23 -153 15z"\n        />\n        <path d="M1399 1534 c-9 -12 -1 -133 10 -135 27 -4 185 -3 191 1 14 9 22 128\n                9 136 -20 12 -200 10 -210 -2z"\n        />\n    </g>\n</svg>',M=(e,t,a=.7,o=350,s=350)=>new Promise((n,r)=>{e.then(e=>{let r=e?e.slice(0):null;r||(r=j()),r=r.replace("[width]",o),r=r.replace("[height]",s),r=r.replace("[color]",t),r=r.replace("[opacity]",a),n(r)})})},fa4b:function(e,t,a){"use strict";var o=a("2b0e"),s=a("8c4f"),n=a("260b"),r=(a("ea7b"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-page"},[t("Navbar",{attrs:{title:"admin",hasMenu:!1}}),t("Admin")],1)}),i=[],l=a("1808"),c={name:"AdminPage",components:{Admin:()=>Promise.resolve().then(a.bind(null,"d824")),Navbar:l["a"]}},p=c,d=(a("b32a"),a("2877")),u=Object(d["a"])(p,r,i,!1,null,null,null),m=u.exports,f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper"},[e.showConfig?t("div",{staticClass:"center"},[t("div",[t("v-btn",{staticClass:"mx-2",attrs:{fab:"","x-small":"",color:"primary"},on:{click:function(t){e.showConfig=!1}}},[t("v-icon",[e._v(" mdi-arrow-left ")])],1)],1),t("div",[t("div",{staticClass:"form-fields"},[t("form",[t("v-text-field",{attrs:{name:"email",type:"email",required:!0,color:"#FFF",label:"Email",rules:[e=>!!e,e=>/.+@.+\..+/.test(e)],autocomplete:"off"},model:{value:e.data.user.email,callback:function(t){e.$set(e.data.user,"email",t)},expression:"data.user.email"}}),t("v-text-field",{attrs:{name:"password",type:"password",required:!0,color:"#FFF",label:"Password",autocomplete:"off"},model:{value:e.data.user.password,callback:function(t){e.$set(e.data.user,"password",t)},expression:"data.user.password"}}),t("v-text-field",{attrs:{name:"confirmPassword",type:"password",required:!0,color:"#FFF",label:"Confirm Password",autocomplete:"off"},model:{value:e.data.user.confirmPassword,callback:function(t){e.$set(e.data.user,"confirmPassword",t)},expression:"data.user.confirmPassword"}})],1)]),t("v-btn",{attrs:{block:"",disabled:e.checkInputs()},on:{click:function(t){return e.createUser()}}},[e._v(" Create Admin User ")])],1)]):t("div",{staticClass:"form"},[t("div",{staticClass:"form-fields"},e._l(e.inputs,(function(a){return t("div",{key:a.name},[t("v-text-field",{attrs:{name:a.name,type:a.type,color:a.color,required:a.required,label:a.label,autocomplete:"off"},model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"input.value"}})],1)})),0),t("div",[t("v-btn",{attrs:{block:""},on:{click:function(t){return e.login()}}},[t("div",[e._v(" "+e._s(e.$t("btn_login"))+" ")])])],1)])])},g=[],h=a("bc3a"),v=a.n(h),y=a("ed08"),b=a("2ef0"),_={name:"ConfigPage",data(){return{showConfig:!1,inputs:[{name:"username",label:"Username",type:"text",color:"#FFF",required:!0,value:""},{name:"password",label:"Password",type:"password",color:"#FFF",required:!0,value:""}],data:{role:{name:"",scopes:[]},user:{name:"",roles:[],email:"",password:"",confirmPassword:""}}}},methods:{checkInputs(){let e=!0;return this.data.user.password===this.data.user.confirmPassword&&""!==this.data.user.password&&""!==this.data.user.confirmPassword&&/.+@.+\..+/.test(this.data.user.email)&&(e=!1),e},async login(){const e={username:this.inputs[0].value,password:this.inputs[1].value};v.a.post("/configuration",e).then(e=>{const{login:t}=e.data;if(!t){const e={open:!0,color:"",text:"error_config_login",timeout:2500,type:"error"};return this.$store.dispatch("updateSnackbar",e)}this.showConfig=!0})},async createUser(){const e=await this.getRoles();if(console.log(e),Object(b["isEmpty"])(e))return;let t=Object(y["b"])("user/config");const a=this.data;n["a"].auth().createUserWithEmailAndPassword(a.user.email,a.user.password).then(o=>{let s={uid:o.user.uid,email:o.user.email,name:a.user.email,active:!0,roles:e};v.a.post(t,s).then(e=>{const{errors:t}=e.data;if(!Object(b["isEmpty"])(t))return this.loading=!1,Object(y["g"])(t);n["a"].auth().sendPasswordResetEmail(a.user.email.toLowerCase()).then(()=>{const e={open:!0,color:"",text:"success_create_user",timeout:2500,type:"success"};this.$store.dispatch("updateSnackbar",e),this.loading=!1}).catch(e=>{const t={open:!0,color:"",text:"error_create_user",timeout:2500,type:"error"};this.$store.dispatch("updateSnackbar",t),this.loading=!1})}).then(()=>{this.close(),this.getUsers()}).catch(e=>{this.deleteUserFirebase(s.email,a.user.password);const t={open:!0,color:"",text:"error_create_user",timeout:2500,type:"error"};this.$store.dispatch("updateSnackbar",t),this.loading=!1})}).catch(e=>{console.log(e);const t={open:!0,color:"",text:"error_create_user",timeout:2500,type:"error"};this.$store.dispatch("updateSnackbar",t),this.loading=!1})},async getRoles(){let e=Object(y["b"])("role/config");try{const t=await v.a.get(e),{data:a,errors:o}=t.data;return Object(b["isEmpty"])(o)?a:(Object(y["g"])(o),[])}catch(t){const e={open:!0,color:"",text:"error_load_roles",timeout:2500,type:"error"};return this.$store.dispatch("updateSnackbar",e),[]}},deleteUserFirebase(e,t){n["a"].auth().signInWithEmailAndPassword(e,t).then(e=>{e.user&&e.user.delete().then(()=>{console.log("user created on firebase, but deleted cause an API error")})}).catch(e=>console.log("error to delete user created on firebase"))}}},k=_,w=(a("5c03"),Object(d["a"])(k,f,g,!1,null,null,null)),x=w.exports,$=function(){var e=this,t=e._self._c;return t("div",{staticClass:"feedback-page"},[t("Navbar",{attrs:{title:"Feedback",hasMenu:!1}}),t("Feedback")],1)},O=[],C=a("ba71"),L={name:"FeedbackPage",components:{Feedback:C["a"],Navbar:l["a"]}},F=L,S=(a("3193"),Object(d["a"])(F,$,O,!1,null,null,null)),j=S.exports,M=function(){var e=this,t=e._self._c;return t("Login")},E=[],I=a("b461"),A={name:"LoginPage",components:{Login:I["a"]}},D=A,P=Object(d["a"])(D,M,E,!1,null,null,null),N=P.exports,T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"map-page"},[t("Navbar",{attrs:{title:"map",hasMenu:!0}}),t("Map")],1)},R=[],G=a("d540"),z={name:"MapPage",components:{Map:G["a"],Navbar:l["a"]}},q=z,U=(a("eba6"),Object(d["a"])(q,T,R,!1,null,null,null)),Y=U.exports,B=function(){var e=this,t=e._self._c;return t("div",{staticClass:"management-page"},[t("Navbar",{attrs:{title:"management",hasMenu:!1}}),t("Management")],1)},H=[],J=a("c447"),V={name:"ManagementPage",components:{Navbar:l["a"],Management:J["a"]}},Z=V,K=(a("4447"),Object(d["a"])(Z,B,H,!1,null,null,null)),W=K.exports;o["default"].use(s["a"]);const Q=new s["a"]({mode:"history",base:"/",routes:[{path:"/",name:"login",component:N},{path:"/config",name:"config",component:x},{path:"/map",name:"map",component:Y,props:!0,meta:{requiresAuth:!0}},{path:"/management",name:"management",component:W,props:!0,meta:{requiresAuth:!0}},{path:"/feedback",name:"feedback",component:j,props:!0,meta:{requiresAuth:!0}},{path:"/admin",name:"admin",component:m,props:!0,meta:{requiresAuth:!0}},{path:"*",redirect:"/"}]});Q.beforeEach(async(e,t,a)=>{const o=e.matched.some(e=>e.meta.requiresAuth);o&&!await n["a"].getCurrentUser()?a("login"):a()});t["a"]=Q},fa6f:function(e,t,a){},fbfe:function(e,t,a){"use strict";a("fa6f")}});